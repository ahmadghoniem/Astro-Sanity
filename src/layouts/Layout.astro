---
import '../main.css';
import Header from "../components/Header.astro";
import { ViewTransitions } from 'astro:transitions';

const { title } = Astro.props;
---
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width" />
    <ViewTransitions />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/images/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/images/favicon-16x16.png"
    />
    <link rel="icon" type="image/x-icon" href="/favicon.ico">

    <link rel="manifest" href="/site.webmanifest" />
    <link
      rel="mask-icon"
      href="/images/safari-pinned-tab.svg"
      color="#5bbad5"
    />


    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    
  </head>
  <body class="min-h-screen bg-background text-foreground" >
    <Header/>
    <main>
      <slot />
    </main>
    <script is:inline>
      // By default, Astro processes and bundles <script> tags, adding support for importing npm modules, writing TypeScript, and more.
const setDarkMode = () => {
      const isSystemColorSchemeDark = window.matchMedia(
        "(prefers-color-scheme: dark)"
      ).matches
      const storageTheme = localStorage.getItem("theme")
      if (!storageTheme && isSystemColorSchemeDark || storageTheme === "dark") 
      document.documentElement.classList.add("dark")
  }
  // Runs on initial navigation
  setDarkMode();

  // Runs on view transitions navigation
  document.addEventListener('astro:after-swap', setDarkMode);

  const handleThemeToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle("dark");
    const isDark = element.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
};

document.addEventListener('astro:page-load', () => {
    document.getElementById("themeToggle").addEventListener("click", handleThemeToggleClick);
  });
    </script>
  </body>
</html>
